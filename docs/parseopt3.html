<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nim. -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Favicon -->
<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
<link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QQQEwksSS9ZWwAAAk1JREFUWMPtll2ITVEUx39nn/O7Y5qR8f05wtCUUr6ZIS++8pEnkZInPImneaCQ5METNdOkeFBKUhMPRIkHKfEuUZSUlGlKPN2TrgfncpvmnntnmlEyq1Z7t89/rf9a6+y99oZxGZf/XeIq61EdtgKXgdXA0xrYAvBjOIF1AI9zvjcC74BSpndrJPkBWDScTF8Aa4E3wDlgHbASaANmVqlcCnwHvgDvgVfAJ+AikAAvgfVZwLnSVZHZaOuKoQi3ZOMi4NkYkpe1p4J7A8BpYAD49hfIy/oqG0+hLomiKP2L5L+1ubn5115S+3OAn4EnwBlgMzCjyt6ZAnQCJ4A7wOs88iRJHvw50HoujuPBoCKwHWiosy8MdfZnAdcHk8dxXFJ3VQbQlCTJvRBCGdRbD4M6uc5glpY3eAihpN5S5w12diSEcCCEcKUO4ljdr15T76ur1FDDLIQQ3qv71EdDOe3Kxj3leRXyk+pxdWnFWod6Wt2bY3de3aSuUHcPBVimHs7mK9WrmeOF6lR1o9qnzskh2ar2qm1qizpfXaPeVGdlmGN5pb09qMxz1Xb1kLqgzn1RyH7JUXW52lr5e/Kqi9qpto7V1atuUzfnARrV7jEib1T76gG2qxdGmXyiekkt1GswPTtek0aBfJp6YySGBfWg2tPQ0FAYgf1stUfdmdcjarbYJEniKIq6gY/Aw+zWHAC+p2labGpqiorFYgGYCEzN7oQdQClN07O1/EfDyGgC0ALMBdYAi4FyK+4H3gLPsxfR1zRNi+NP7nH5J+QntnXe5B5mpfQAAAAASUVORK5CYII=">

<!-- Google fonts -->
<link href='https://fonts.googleapis.com/css?family=Lato:400,600,900' rel='stylesheet' type='text/css'/>
<link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600' rel='stylesheet' type='text/css'/>

<!-- CSS -->
<title>parseopt3</title>
<link rel="stylesheet" type="text/css" href="nimdoc.out.css">

<script type="text/javascript" src="dochack.js"></script>

<script type="text/javascript">
function main() {
  var pragmaDots = document.getElementsByClassName("pragmadots");
  for (var i = 0; i < pragmaDots.length; i++) {
    pragmaDots[i].onclick = function(event) {
      // Hide tease
      event.target.parentNode.style.display = "none";
      // Show actual
      event.target.parentNode.nextElementSibling.style.display = "inline";
    }
  }

  const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
  function switchTheme(e) {
      if (e.target.checked) {
          document.documentElement.setAttribute('data-theme', 'dark');
          localStorage.setItem('theme', 'dark');
      } else {
          document.documentElement.setAttribute('data-theme', 'light');
          localStorage.setItem('theme', 'light');
      }
  }

  toggleSwitch.addEventListener('change', switchTheme, false);


  if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
    document.documentElement.setAttribute('data-theme', "dark");
    toggleSwitch.checked = true;
  } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) {
    document.documentElement.setAttribute('data-theme', "light");
    toggleSwitch.checked = false;
  } else {
    const currentTheme = localStorage.getItem('theme') ? localStorage.getItem('theme') : null;
    if (currentTheme) {
      document.documentElement.setAttribute('data-theme', currentTheme);

      if (currentTheme === 'dark') {
        toggleSwitch.checked = true;
      }
    }
  }
}
</script>

</head>
<body onload="main()">
<div class="document" id="documentId">
  <div class="container">
    <h1 class="title">parseopt3</h1>
    <div class="row">
  <div class="three columns">
  <div class="theme-switch-wrapper">
    <label class="theme-switch" for="checkbox">
      <input type="checkbox" id="checkbox" />
      <div class="slider round"></div>
    </label>
    &nbsp;&nbsp;&nbsp; <em>Dark Mode</em>
  </div>
  <div id="global-links">
    <ul class="simple">
    </ul>
  </div>
  <div id="searchInputDiv">
    Search: <input type="text" id="searchInput"
      onkeyup="search()" />
  </div>
  <div>
    Group by:
    <select onchange="groupBy(this.value)">
      <option value="section">Section</option>
      <option value="type">Type</option>
    </select>
  </div>
  <ul class="simple simple-toc" id="toc-list">
<li>
  <a class="reference reference-toplevel" href="#7" id="57">Types</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#CmdLineKind"
    title="CmdLineKind = enum
  cmdEnd,                     ## end of command line reached
  cmdArgument,                ## argument detected
  cmdLongOption,              ## a long option ``--option`` detected
  cmdShortOption,             ## a short option ``-c`` detected
  cmdError                    ## error in primary option syntax usage"><wbr />Cmd<wbr />Line<wbr />Kind<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#OptParser"
    title="OptParser = object of RootObj
  cmd*: seq[string]            ## command line being parsed
  pos*: int                    ## current command parameter to inspect
  off*: int                    ## current offset in cmd[pos] for short key block
  optsDone*: bool              ## &quot;--&quot; has been seen
  shortNoVal*: set[char]       ## 1-letter options not requiring optarg
  longNoVal*: CritBitTree[string] ## long options not requiring optarg
  stopWords*: CritBitTree[string] ## special literal parameters acting like &quot;--&quot;
  requireSep*: bool            ## require separator between option key &amp; val
  sepChars*: set[char]         ## all the chars that can be valid separators
  opChars*: set[char]          ## all chars that can prefix a sepChar
  sep*: string                 ## actual string separating key &amp; value
  message*: string             ## message to display upon cmdError
  kind*: CmdLineKind           ## the detected command line token
  key*, val*: TaintedString     ## key and value pair; ``key`` is the option
                         ## or the argument, ``value`` is not &quot;&quot; if
                         ## the option was given a value"><wbr />Opt<wbr />Parser<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#GetoptResult"
    title="GetoptResult = tuple[kind: CmdLineKind, key, val: TaintedString]"><wbr />Getopt<wbr />Result<span class="attachedType"></span></a></li>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#12" id="62">Procs</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#optionNormalize%2Cstring%2Cstring"
    title="optionNormalize(s: string; wordSeparators = &quot;_-&quot;): string"><wbr />option<wbr />Normalize<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#valsWithPfx%2CCritBitTree%5BT%5D%2Cstring"
    title="valsWithPfx[T](cb: CritBitTree[T]; key: string): seq[T]"><wbr />vals<wbr />With<wbr />Pfx<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#lengthen%2CCritBitTree%5BT%5D%2Cstring"
    title="lengthen[T](cb: CritBitTree[T]; key: string): string"><wbr />lengthen<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#initOptParser%2Cseq%5BT%5D%5Bstring%5D%2Cset%5Bchar%5D%2Cseq%5BT%5D%5Bstring%5D%2Cset%5Bchar%5D%2Cseq%5BT%5D%5Bstring%5D"
    title="initOptParser(cmdline: seq[string] = commandLineParams();
              shortNoVal: set[char] = {}; longNoVal: seq[string] = @[];
              requireSeparator = false; sepChars = {&apos;=&apos;, &apos;:&apos;}; opChars: set[char] = {};
              stopWords: seq[string] = @[]): OptParser"><wbr />init<wbr />Opt<wbr />Parser<span class="attachedType">OptParser</span></a></li>
  <li><a class="reference" href="#initOptParser%2Cstring"
    title="initOptParser(cmdline: string): OptParser"><wbr />init<wbr />Opt<wbr />Parser<span class="attachedType">OptParser</span></a></li>
  <li><a class="reference" href="#next%2COptParser"
    title="next(p: var OptParser)"><wbr />next<span class="attachedType">OptParser</span></a></li>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#15" id="65">Iterators</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#getopt.i%2COptParser"
    title="getopt(p: var OptParser): GetoptResult"><wbr />getopt<span class="attachedType">OptParser</span></a></li>
  <li><a class="reference" href="#getopt.i%2Cset%5Bchar%5D%2Cseq%5BT%5D%5Bstring%5D%2Cset%5Bchar%5D%2Cseq%5BT%5D%5Bstring%5D"
    title="getopt(cmdline = commandLineParams(); shortNoVal: set[char] = {};
       longNoVal: seq[string] = @[]; requireSeparator = false; sepChars = {&apos;=&apos;, &apos;:&apos;};
       opChars: set[char] = {}; stopWords: seq[string] = @[]): GetoptResult"><wbr />getopt<span class="attachedType">GetoptResult</span></a></li>

  </ul>
</li>

</ul>

  </div>
  <div class="nine columns" id="content">
  <div id="tocRoot"></div>
  
  <p class="module-desc"><p>This module provides a Nim command line parser that is mostly API compatible with the Nim standard library parseopt (and the code derives from that). It supports one convenience iterator over all command line options and some lower-level features. Supported command syntax (here <tt class="docutils literal"><span class="pre">=``|</span></tt>:`` may be any char in <tt class="docutils literal"><span class="pre">sepChars</span></tt>):</p>
<p>1. short option bundles: <tt class="docutils literal"><span class="pre">-abx</span></tt>  (where a, b, x <em>are in</em> <tt class="docutils literal"><span class="pre">shortNoVal</span></tt>)</p>
<p>1a. bundles with one final value: <tt class="docutils literal"><span class="pre">-abc:Bar</span></tt>, <tt class="docutils literal"><span class="pre">-abc=Bar</span></tt>, <tt class="docutils literal"><span class="pre">-c Bar</span></tt>, <tt class="docutils literal"><span class="pre">-abcBar</span></tt> (where <tt class="docutils literal"><span class="pre">c</span></tt> is <em>not in</em> <tt class="docutils literal"><span class="pre">shortNoVal</span></tt>)</p>
<p>2. long options with values: <tt class="docutils literal"><span class="pre">--foo:bar</span></tt>, <tt class="docutils literal"><span class="pre">--foo=bar</span></tt>, <tt class="docutils literal"><span class="pre">--foo bar</span></tt> (where <tt class="docutils literal"><span class="pre">foo</span></tt> is <em>not in</em> <tt class="docutils literal"><span class="pre">longNoVal</span></tt>)</p>
<p>2a. long options without vals: <tt class="docutils literal"><span class="pre">--baz</span></tt> (where <tt class="docutils literal"><span class="pre">baz</span></tt> is in <tt class="docutils literal"><span class="pre">longNoVal</span></tt>)</p>
<p>3. command parameters: everything else | anything after &quot;--&quot; or a stop word.</p>
<p>The above is a <em>superset</em> of usual POSIX command syntax - it should accept any POSIX-inspired input, but it also accepts more forms/styles. (Note that POSIX itself is not super strict about this part of the standard.  See: <a class="reference external" href="http://pubs.opengroup.org/onlinepubs/009604499/basedefs/xbd_chap12.html">http://pubs.opengroup.org/onlinepubs/009604499/basedefs/xbd_chap12.html</a>)</p>
<p>When <tt class="docutils literal"><span class="pre">optionNormalize(key)</span></tt> is used, command authors provide command users additional flexibility to <tt class="docutils literal"><span class="pre">--spell_multi-word_options -aVarietyOfWays --as-Per_User-Preference</span></tt>.  This is similar to Nim style-insensitive identifier syntax, but by default allows dash ('-') as well as underscore ('_') word separation.</p>
<p>The &quot;separator free&quot; forms above require appropriate <tt class="docutils literal"><span class="pre">shortNoVal</span></tt> and <tt class="docutils literal"><span class="pre">longNoVal</span></tt> lists to designate option keys that take no value (as well as <tt class="docutils literal"><span class="pre">requireSeparator == false</span></tt>).  If such lists are empty, the user must use separators when providing any value.</p>
<p>A notable subtlety is when the first character of an option value is one of <tt class="docutils literal"><span class="pre">sepChars</span></tt>.  Even if <tt class="docutils literal"><span class="pre">requireSeparator</span></tt> is <tt class="docutils literal"><span class="pre">false</span></tt>, passing such option values requires either A) putting the value in the next command parameter, as in <tt class="docutils literal"><span class="pre">&quot;-c :&quot;</span></tt> or B) prefixing the value with an element of <tt class="docutils literal"><span class="pre">sepChars</span></tt>, as in <tt class="docutils literal"><span class="pre">-c=:</span></tt> or <tt class="docutils literal"><span class="pre">-c::</span></tt>.  Both choices fit into common quoting styles. It seems likely a POSIX-habituated end-user's second guess (after <tt class="docutils literal"><span class="pre">&quot;-c:&quot;</span></tt> errored out with &quot;argument expected&quot;) would just work as they expected. POSIX itself encourages authors &amp; users to use the <tt class="docutils literal"><span class="pre">&quot;-c :&quot;</span></tt> form anyway. This small deviation lets this parser accept valid invocations with the original Nim option parser command syntax (with the same semantics), easing transition.</p>
<p>To ease &quot;nested&quot; command-line parsing (such as with &quot;git&quot; where there may be early global options, a subcommand and later subcommand options), this parser also supports a set of &quot;stop words&quot; - special whole command parameters that prevent subsequent parameters being interpreted as options.  This feature makes it easy to fully process a command line and then re-process its tail rather than mandating breaking out at a stop word with a manual test.  Stop words are basically just like a POSIX &quot;--&quot; (which this parser also supports - even if &quot;--&quot; is not in <tt class="docutils literal"><span class="pre">stopWords</span></tt>).  Such stop words (or &quot;--&quot;) can still be the <strong>values</strong> of option keys with no effect.  Only usage as a non-option command parameter acts to stop possible option-treatment of later parameters.</p>
<p>To facilitate syntax for operations beyond simple assignment, <tt class="docutils literal"><span class="pre">opChars</span></tt> is a set of chars that may prefix an element of <tt class="docutils literal"><span class="pre">sepChars</span></tt>. The <tt class="docutils literal"><span class="pre">sep</span></tt> member of <tt class="docutils literal"><span class="pre">OptParser</span></tt> is the actual separator used for the current option, if any. E.g, a user entering &quot;=&quot;  causes <tt class="docutils literal"><span class="pre">sep == &quot;=&quot;</span></tt> while entering &quot;+=&quot; gets <tt class="docutils literal"><span class="pre">sep == &quot;+=&quot;</span></tt>, and &quot;+/-+=&quot; gets <tt class="docutils literal"><span class="pre">sep == &quot;+/-+=&quot;</span></tt>.</p>
</p>
  <div class="section" id="7">
<h1><a class="toc-backref" href="#7">Types</a></h1>
<dl class="item">
<a id="CmdLineKind"></a>
<dt><pre><a href="parseopt3.html#CmdLineKind"><span class="Identifier">CmdLineKind</span></a> <span class="Other">=</span> <span class="Keyword">enum</span>
  <span class="Identifier">cmdEnd</span><span class="Other">,</span>                     <span class="Comment">## end of command line reached</span>
  <span class="Identifier">cmdArgument</span><span class="Other">,</span>                <span class="Comment">## argument detected</span>
  <span class="Identifier">cmdLongOption</span><span class="Other">,</span>              <span class="Comment">## a long option ``--option`` detected</span>
  <span class="Identifier">cmdShortOption</span><span class="Other">,</span>             <span class="Comment">## a short option ``-c`` detected</span>
  <span class="Identifier">cmdError</span>                    <span class="Comment">## error in primary option syntax usage</span></pre></dt>
<dd>

the detected command line token

</dd>
<a id="OptParser"></a>
<dt><pre><a href="parseopt3.html#OptParser"><span class="Identifier">OptParser</span></a> <span class="Other">=</span> <span class="Keyword">object</span> <span class="Keyword">of</span> <span class="Identifier">RootObj</span>
  <span class="Identifier">cmd</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span>            <span class="Comment">## command line being parsed</span>
  <span class="Identifier">pos</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">int</span>                    <span class="Comment">## current command parameter to inspect</span>
  <span class="Identifier">off</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">int</span>                    <span class="Comment">## current offset in cmd[pos] for short key block</span>
  <span class="Identifier">optsDone</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">bool</span>              <span class="Comment">## &quot;--&quot; has been seen</span>
  <span class="Identifier">shortNoVal</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">set</span><span class="Other">[</span><span class="Identifier">char</span><span class="Other">]</span>       <span class="Comment">## 1-letter options not requiring optarg</span>
  <span class="Identifier">longNoVal</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">CritBitTree</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span> <span class="Comment">## long options not requiring optarg</span>
  <span class="Identifier">stopWords</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">CritBitTree</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span> <span class="Comment">## special literal parameters acting like &quot;--&quot;</span>
  <span class="Identifier">requireSep</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">bool</span>            <span class="Comment">## require separator between option key &amp; val</span>
  <span class="Identifier">sepChars</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">set</span><span class="Other">[</span><span class="Identifier">char</span><span class="Other">]</span>         <span class="Comment">## all the chars that can be valid separators</span>
  <span class="Identifier">opChars</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">set</span><span class="Other">[</span><span class="Identifier">char</span><span class="Other">]</span>          <span class="Comment">## all chars that can prefix a sepChar</span>
  <span class="Identifier">sep</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">string</span>                 <span class="Comment">## actual string separating key &amp; value</span>
  <span class="Identifier">message</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">string</span>             <span class="Comment">## message to display upon cmdError</span>
  <span class="Identifier">kind</span><span class="Operator">*</span><span class="Other">:</span> <a href="parseopt3.html#CmdLineKind"><span class="Identifier">CmdLineKind</span></a>           <span class="Comment">## the detected command line token</span>
  <span class="Identifier">key</span><span class="Operator">*</span><span class="Other">,</span> <span class="Identifier">val</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">TaintedString</span>     <span class="Comment">## key and value pair; ``key`` is the option</span>
                         <span class="Comment">## or the argument, ``value`` is not &quot;&quot; if</span>
                         <span class="Comment">## the option was given a value</span>
  </pre></dt>
<dd>

object to implement the command line parser

</dd>
<a id="GetoptResult"></a>
<dt><pre><a href="parseopt3.html#GetoptResult"><span class="Identifier">GetoptResult</span></a> <span class="Other">=</span> <span class="Keyword">tuple</span><span class="Other">[</span><span class="Identifier">kind</span><span class="Other">:</span> <a href="parseopt3.html#CmdLineKind"><span class="Identifier">CmdLineKind</span></a><span class="Other">,</span> <span class="Identifier">key</span><span class="Other">,</span> <span class="Identifier">val</span><span class="Other">:</span> <span class="Identifier">TaintedString</span><span class="Other">]</span></pre></dt>
<dd>



</dd>

</dl></div>
<div class="section" id="12">
<h1><a class="toc-backref" href="#12">Procs</a></h1>
<dl class="item">
<a id="optionNormalize,string,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#optionNormalize%2Cstring%2Cstring"><span class="Identifier">optionNormalize</span></a><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">wordSeparators</span> <span class="Other">=</span> <span class="StringLit">&quot;_-&quot;</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">noSideEffect</span><span class="Other">,</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Normalizes option key <tt class="docutils literal"><span class="pre">s</span></tt> to allow command syntax to be style-insensitive in a similar way to Nim identifier syntax.</p>
<p>Specifically this means to convert <em>all but the first</em> char to lower case and remove chars in <tt class="docutils literal"><span class="pre">wordSeparators</span></tt> ('_' and '-') by default.  This way users can type &quot;command --my-opt-key&quot; or &quot;command --myOptKey&quot; and so on.</p>
<p>Example:</p>
<pre class="listing"><span class="Keyword">for</span> <span class="Identifier">kind</span><span class="Punctuation">,</span> <span class="Identifier">key</span><span class="Punctuation">,</span> <span class="Identifier">val</span> <span class="Keyword">in</span> <span class="Identifier">p</span><span class="Operator">.</span><span class="Identifier">getopt</span><span class="Punctuation">(</span><span class="Punctuation">)</span><span class="Punctuation">:</span>
  <span class="Keyword">case</span> <span class="Identifier">kind</span>
  <span class="Keyword">of</span> <span class="Identifier">cmdLongOption</span><span class="Punctuation">,</span> <span class="Identifier">cmdShortOption</span><span class="Punctuation">:</span>
    <span class="Keyword">case</span> <span class="Identifier">optionNormalize</span><span class="Punctuation">(</span><span class="Identifier">key</span><span class="Punctuation">)</span>
    <span class="Keyword">of</span> <span class="StringLit">&quot;myoptkey&quot;</span><span class="Punctuation">,</span> <span class="StringLit">&quot;m&quot;</span><span class="Punctuation">:</span> <span class="Identifier">doSomething</span><span class="Punctuation">(</span><span class="Punctuation">)</span></pre>

</dd>
<a id="valsWithPfx,CritBitTree[T],string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#valsWithPfx%2CCritBitTree%5BT%5D%2Cstring"><span class="Identifier">valsWithPfx</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">cb</span><span class="Other">:</span> <span class="Identifier">CritBitTree</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span></pre></dt>
<dd>



</dd>
<a id="lengthen,CritBitTree[T],string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#lengthen%2CCritBitTree%5BT%5D%2Cstring"><span class="Identifier">lengthen</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">cb</span><span class="Other">:</span> <span class="Identifier">CritBitTree</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span></pre></dt>
<dd>

Use <tt class="docutils literal"><span class="pre">cb</span></tt> to find normalized long form of <tt class="docutils literal"><span class="pre">key</span></tt>. Return empty string if ambiguous or unchanged string on no match.

</dd>
<a id="initOptParser,seq[T][string],set[char],seq[T][string],set[char],seq[T][string]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#initOptParser%2Cseq%5BT%5D%5Bstring%5D%2Cset%5Bchar%5D%2Cseq%5BT%5D%5Bstring%5D%2Cset%5Bchar%5D%2Cseq%5BT%5D%5Bstring%5D"><span class="Identifier">initOptParser</span></a><span class="Other">(</span><span class="Identifier">cmdline</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span> <span class="Other">=</span> <span class="Identifier">commandLineParams</span><span class="Other">(</span><span class="Other">)</span><span class="Other">;</span>
                  <span class="Identifier">shortNoVal</span><span class="Other">:</span> <span class="Identifier">set</span><span class="Other">[</span><span class="Identifier">char</span><span class="Other">]</span> <span class="Other">=</span> <span class="Other">{</span><span class="Other">}</span><span class="Other">;</span> <span class="Identifier">longNoVal</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span> <span class="Other">=</span> <span class="Operator">@</span><span class="Other">[</span><span class="Other">]</span><span class="Other">;</span>
                  <span class="Identifier">requireSeparator</span> <span class="Other">=</span> <span class="Identifier">false</span><span class="Other">;</span> <span class="Identifier">sepChars</span> <span class="Other">=</span> <span class="Other">{</span><span class="CharLit">'='</span><span class="Other">,</span> <span class="CharLit">':'</span><span class="Other">}</span><span class="Other">;</span>
                  <span class="Identifier">opChars</span><span class="Other">:</span> <span class="Identifier">set</span><span class="Other">[</span><span class="Identifier">char</span><span class="Other">]</span> <span class="Other">=</span> <span class="Other">{</span><span class="Other">}</span><span class="Other">;</span> <span class="Identifier">stopWords</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span> <span class="Other">=</span> <span class="Operator">@</span><span class="Other">[</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <a href="parseopt3.html#OptParser"><span class="Identifier">OptParser</span></a> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Initializes a command line parse. <tt class="docutils literal"><span class="pre">cmdline</span></tt> should not contain parameter 0, typically the program name.  If <tt class="docutils literal"><span class="pre">cmdline</span></tt> is not given, default to current program parameters.</p>
<p><tt class="docutils literal"><span class="pre">shortNoVal</span></tt> and <tt class="docutils literal"><span class="pre">longNoVal</span></tt> specify respectively one-letter and long option keys that do _<a class="reference external" href="#not">not</a> take arguments.</p>
<p>If <tt class="docutils literal"><span class="pre">requireSeparator</span></tt> is true, then option keys &amp; values must be separated by an element of sepChars ('='|':' by default) in either short or long option contexts.  If requireSeparator==false, the parser understands that only non-bool options will expect args and users may say <tt class="docutils literal"><span class="pre">-aboVal</span></tt> or <tt class="docutils literal"><span class="pre">-o Val</span></tt> or <tt class="docutils literal"><span class="pre">--opt Val</span></tt> [ as well as the <tt class="docutils literal"><span class="pre">-o:Val``|</span></tt>--opt=Val`` style which always works ].</p>
<p>Parameters following either &quot;--&quot; or any literal parameter in stopWords are never interpreted as options.</p>


</dd>
<a id="initOptParser,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#initOptParser%2Cstring"><span class="Identifier">initOptParser</span></a><span class="Other">(</span><span class="Identifier">cmdline</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <a href="parseopt3.html#OptParser"><span class="Identifier">OptParser</span></a> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">ReadIOEffect</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Initializes option parses with cmdline.  Splits cmdline in on spaces and calls initOptParser(openarray[string]).  Should use a proper tokenizer.

</dd>
<a id="next,OptParser"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#next%2COptParser"><span class="Identifier">next</span></a><span class="Other">(</span><span class="Identifier">p</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="parseopt3.html#OptParser"><span class="Identifier">OptParser</span></a><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>



</dd>

</dl></div>
<div class="section" id="15">
<h1><a class="toc-backref" href="#15">Iterators</a></h1>
<dl class="item">
<a id="getopt.i,OptParser"></a>
<dt><pre><span class="Keyword">iterator</span> <a href="#getopt.i%2COptParser"><span class="Identifier">getopt</span></a><span class="Other">(</span><span class="Identifier">p</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="parseopt3.html#OptParser"><span class="Identifier">OptParser</span></a><span class="Other">)</span><span class="Other">:</span> <a href="parseopt3.html#GetoptResult"><span class="Identifier">GetoptResult</span></a> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

An convenience iterator for iterating over the given OptParser object. Example:<pre class="listing"><span class="Keyword">var</span> <span class="Identifier">p</span> <span class="Operator">=</span> <span class="Identifier">initOptParser</span><span class="Punctuation">(</span><span class="StringLit">&quot;--left --debug:3 -l=4 -r:2&quot;</span><span class="Punctuation">)</span>
<span class="Keyword">for</span> <span class="Identifier">kind</span><span class="Punctuation">,</span> <span class="Identifier">key</span><span class="Punctuation">,</span> <span class="Identifier">val</span> <span class="Keyword">in</span> <span class="Identifier">p</span><span class="Operator">.</span><span class="Identifier">getopt</span><span class="Punctuation">(</span><span class="Punctuation">)</span><span class="Punctuation">:</span>
  <span class="Keyword">case</span> <span class="Identifier">kind</span>
  <span class="Keyword">of</span> <span class="Identifier">cmdArgument</span><span class="Punctuation">:</span>
    <span class="Identifier">filename</span> <span class="Operator">=</span> <span class="Identifier">key</span>
  <span class="Keyword">of</span> <span class="Identifier">cmdLongOption</span><span class="Punctuation">,</span> <span class="Identifier">cmdShortOption</span><span class="Punctuation">:</span>
    <span class="Keyword">case</span> <span class="Identifier">key</span>
    <span class="Keyword">of</span> <span class="StringLit">&quot;help&quot;</span><span class="Punctuation">,</span> <span class="StringLit">&quot;h&quot;</span><span class="Punctuation">:</span> <span class="Identifier">writeHelp</span><span class="Punctuation">(</span><span class="Punctuation">)</span>
    <span class="Keyword">of</span> <span class="StringLit">&quot;version&quot;</span><span class="Punctuation">,</span> <span class="StringLit">&quot;v&quot;</span><span class="Punctuation">:</span> <span class="Identifier">writeVersion</span><span class="Punctuation">(</span><span class="Punctuation">)</span>
  <span class="Keyword">of</span> <span class="Identifier">cmdEnd</span><span class="Punctuation">:</span> <span class="Identifier">assert</span><span class="Punctuation">(</span><span class="Identifier">false</span><span class="Punctuation">)</span> <span class="Comment"># cannot happen</span>
<span class="Keyword">if</span> <span class="Identifier">filename</span> <span class="Operator">==</span> <span class="StringLit">&quot;&quot;</span><span class="Punctuation">:</span>
  <span class="Comment"># no filename has been given, so we show the help:</span>
  <span class="Identifier">writeHelp</span><span class="Punctuation">(</span><span class="Punctuation">)</span></pre>

</dd>
<a id="getopt.i,set[char],seq[T][string],set[char],seq[T][string]"></a>
<dt><pre><span class="Keyword">iterator</span> <a href="#getopt.i%2Cset%5Bchar%5D%2Cseq%5BT%5D%5Bstring%5D%2Cset%5Bchar%5D%2Cseq%5BT%5D%5Bstring%5D"><span class="Identifier">getopt</span></a><span class="Other">(</span><span class="Identifier">cmdline</span> <span class="Other">=</span> <span class="Identifier">commandLineParams</span><span class="Other">(</span><span class="Other">)</span><span class="Other">;</span> <span class="Identifier">shortNoVal</span><span class="Other">:</span> <span class="Identifier">set</span><span class="Other">[</span><span class="Identifier">char</span><span class="Other">]</span> <span class="Other">=</span> <span class="Other">{</span><span class="Other">}</span><span class="Other">;</span>
               <span class="Identifier">longNoVal</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span> <span class="Other">=</span> <span class="Operator">@</span><span class="Other">[</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">requireSeparator</span> <span class="Other">=</span> <span class="Identifier">false</span><span class="Other">;</span>
               <span class="Identifier">sepChars</span> <span class="Other">=</span> <span class="Other">{</span><span class="CharLit">'='</span><span class="Other">,</span> <span class="CharLit">':'</span><span class="Other">}</span><span class="Other">;</span> <span class="Identifier">opChars</span><span class="Other">:</span> <span class="Identifier">set</span><span class="Other">[</span><span class="Identifier">char</span><span class="Other">]</span> <span class="Other">=</span> <span class="Other">{</span><span class="Other">}</span><span class="Other">;</span>
               <span class="Identifier">stopWords</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span> <span class="Other">=</span> <span class="Operator">@</span><span class="Other">[</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <a href="parseopt3.html#GetoptResult"><span class="Identifier">GetoptResult</span></a> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

This is an convenience iterator for iterating over the command line. Parameters here are the same as for initOptParser.  Example: See above for a more detailed example<pre class="listing"><span class="Keyword">for</span> <span class="Identifier">kind</span><span class="Punctuation">,</span> <span class="Identifier">key</span><span class="Punctuation">,</span> <span class="Identifier">val</span> <span class="Keyword">in</span> <span class="Identifier">getopt</span><span class="Punctuation">(</span><span class="Punctuation">)</span><span class="Punctuation">:</span>
  <span class="Comment"># this will iterate over all arguments passed to the cmdline.</span>
  <span class="Keyword">continue</span></pre>

</dd>

</dl></div>

  </div>
</div>

    <div class="row">
      <div class="twelve-columns footer">
        <span class="nim-sprite"></span>
        <br/>
        <small style="color: var(--hint);">Made with Nim. Generated: 2020-01-28 14:38:23 UTC</small>
      </div>
    </div>
  </div>
</div>

</body>
</html>
